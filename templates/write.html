{% extends "layout.html" %}
{% set page = "write" %}

{% block content %}
{% if status == "need_login" %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100">
    <main class="max-w-4xl mx-auto px-6 py-8 pb-32">
        <div class="bg-white/90 p-6 rounded-2xl shadow-xl text-center">
            <h2 class="text-2xl font-bold text-slate-800 mb-4">로그인이 필요한 서비스입니다.</h2>
            <a href="/login">
                <button class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700">
                    로그인 하러 가기
                </button>
            </a>
        </div>
        {% else %}
        <div
            class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4">
            <div class="container">
                <h1 class="text-4xl font-bold mb-6 text-gray-800">새 글 작성</h1>


                <label for="title">제목</label>
                <input type="text" id="title" placeholder="제목을 입력하세요">


                <label for="content">내용</label>
                <textarea id="content" placeholder="내용을 입력하세요 (최대 100자)" maxlength="100"></textarea>
                <div id="charCount" style="text-align:right; font-size:0.85em; color:#888;">0/100</div>


                <!-- 선택된 음악 표시 (공유버튼으로 들어온 경우) -->
                <div id="sharedMusicSection" class="hidden mt-6">
                    <strong>선택한 음악:</strong>
                    <div class="flex items-center bg-white p-4 rounded-xl shadow mt-2">
                        <img id="sharedAlbumCover" src="" alt="앨범 커버"
                            class="w-20 h-20 object-cover rounded-lg mr-4 hidden">
                        <div>
                            <p id="sharedTitle" class="text-lg font-semibold text-slate-800"></p>
                            <p id="sharedArtist" class="text-slate-600"></p>
                        </div>
                    </div>
                </div>


                <!-- 검색 및 직접 입력 영역 (공유가 아닐 때만 보여짐) -->
                <div id="musicInputSection">
                    <!-- 음악 검색 입력 -->
                    <div id="searchSection">
                        <label for="musicSearch">음악 검색</label>
                        <input type="text" id="musicSearch" placeholder="곡명 또는 가수명 입력">
                        <ul id="suggestions" class="bg-white border rounded mt-2 max-h-48 overflow-y-auto"></ul>
                    </div>


                    <button id="toggleInputModeBtn" onclick="toggleInputMode()"
                        class="text-sm text-black hover:underline">
                        직접 입력하기
                    </button>


                    <!-- 직접 입력 카드 -->
                    <div id="manualInputSection" class="hidden mt-4">
                        <label for="manualTitle">곡명</label>
                        <input type="text" id="manualTitle" placeholder="곡명을 직접 입력하세요.">


                        <label for="manualArtist" class="mt-2 block">가수명</label>
                        <input type="text" id="manualArtist" placeholder="가수명을 직접 입력하세요.">
                    </div>
                </div>


                <!-- 선택된 음악 정보 표시 (검색 또는 직접입력 결과) -->
                <div class="music-info mt-4 hidden" id="musicDetailsWrapper">
                    <strong>선택한 음악:</strong>
                    <div id="musicDetails">아직 선택되지 않음</div>
                </div>


                <div class="button-group mt-6">
                    <button id="submitBtn" type="button" onclick="submitPost()" style="color:white; background:#4f46e5;"
                        class="px-4 py-2 rounded-lg hover:bg-indigo-700 disabled:bg-gray-400">
                        게시하기
                    </button>

                </div>
            </div>
        </div>

        {% endif %}
        {% endblock %}